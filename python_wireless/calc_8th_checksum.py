# -*- coding: utf-8 -*-

"""
PIN码校验和的计算方式

使用WPS（Wi-Fi Protected Setup）的路由器生成PIN码时，遵循特定的算法，其中包括校验和的计算。

WPS PIN由8位数字组成，其中前7位是随机生成的，第8位是通过前7位计算得到的校验和。

对于大部分实现了WPS标准的设备，校验和的计算遵循以下算法：
从左到右，将PIN码的前7位数字每位分别乘以3、1、3、1、3、1、3的模式（即交替乘以3和1）。
将所有乘积相加。
将总和除以10，并取其余数（即计算总和模10）。
如果余数不为0，则用10减去这个余数，得到的数字就是第8位的校验和。如果余数为0，则校验和也是0。

下面Python示例，演示了如何基于前7位的PIN计算第8位的校验和
"""

def calculate_checksum(pin):
    accum = 0
    while pin:
        # 从右侧开始处理数字
        digit = pin % 10
        accum += 3 * digit
        pin //= 10  # 删除处理过的最后一位

        # 如果还有数字，再处理一次，这次乘以1
        if pin:
            digit = pin % 10
            accum += digit
            pin //= 10  # 删除处理过的最后一位

    # 计算校验和
    checksum = (10 - accum % 10) % 10
    return checksum


if __name__ == '__main__':
    pin = 2006907     # 7-digit    20069070
    # pin = 5237180   # 7-digit  5237180
    checksum = calculate_checksum(pin)
    print(f"[1] WPS PIN code is: {pin}{checksum}")

