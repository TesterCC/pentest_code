import sys
import yara


def SCAN_YARA(s, buff):
    rules = yara.compile(s.yara_rule_path)

    results = {}
    if rules:
        matches = rules.match(data=buff)
        if matches:
            for m in matches:
                if m.meta:
                    results['%s' % m.rule] = m.meta
                else:
                    results['%s' % m.rule] = 'No Meta Provided'
    return results
