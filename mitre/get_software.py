# coding=utf-8
"""
DATE:   2022/5/12
AUTHOR: TesterCC
"""
from itertools import chain
from stix2 import Filter, MemoryStore

src = MemoryStore()
src.load_from_file("enterprise-attack-v11.json")

def get_software(thesrc):
    return list(chain.from_iterable(
        thesrc.query(f) for f in [
            Filter("type", "=", "tool"),
            Filter("type", "=", "malware")
        ]
    ))
get_software(src)
