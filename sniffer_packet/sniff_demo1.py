# coding=utf-8
"""
DATE:   2021/8/9
AUTHOR: TesterCC
"""

# 抓包 sniffer packet; 发包forward packet
# ref: https://cloud.tencent.com/developer/article/1694737


from scapy.all import *


def pack_callback(packet):
    print(packet.show())
    if packet['Ether'].payload:
        print(packet['Ether'].src)
        print(packet['Ether'].dst)
        print(packet['Ether'].type)

    # 这种写法容易报错
    if packet['ARP'].payload:
        print(packet['ARP'].psrc)
        print(packet['ARP'].pdst)
        print(packet['ARP'].hwsrc)
        print(packet['ARP'].hwdst)
    time.sleep(2)


# filter str
filterstr = "arp"
sniff(filter=filterstr, prn=pack_callback, iface='ens33', count=0)
