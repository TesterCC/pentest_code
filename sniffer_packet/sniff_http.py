# coding=utf-8
"""
DATE:   2021/8/9
AUTHOR: TesterCC
"""

# https://blog.csdn.net/zhangpeterx/article/details/89929290

from scapy.all import *

stars = lambda n: "*" * n


def GET_print(packet):
    return "\n".join((
        stars(10) + "GET PACKET" + stars(10),
        "\n".join(packet.sprintf("{Raw:%Raw.load%}").split(r"\r\n")),
        stars(30)))


sniff(
    iface='ens33',
    prn=GET_print,
    lfilter=lambda p: "GET" in str(p),
    filter="tcp")
