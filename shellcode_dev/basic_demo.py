#!/usr/bin/env python
"""
pip install capstone -i https://pypi.tuna.tsinghua.edu.cn/simple
利用Python的capstone库，反编译机器码为汇编格式。
ref:
https://forum.butian.net/share/1244
https://www.capstone-engine.org/lang_python.html
"""

from capstone import *

# step 0, shellcode example
code = b"\x55\x48\x8b\x05\xb8\x13\x00\x00"

# x64
md = Cs(CS_ARCH_X86, CS_MODE_64)
# md.detail = True

# step 3, format print
for i in md.disasm(code, 0x1000):
    print("0x%x:\t%s\t%s" % (i.address, i.mnemonic, i.op_str))
