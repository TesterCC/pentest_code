# -*- coding: utf-8 -*-

"""
RC4 Demo
pip install pycryptodome -i https://pypi.tuna.tsinghua.edu.cn/simple

RC4 (ARC4 or ARCFOUR, meaning Alleged RC4)
"""

from Crypto.Cipher import ARC4


def rc4_encrypt(key, plaintext):
    cipher = ARC4.new(key)
    ciphertext = cipher.encrypt(plaintext)
    return ciphertext


def rc4_decrypt(key, ciphertext):
    cipher = ARC4.new(key)
    plaintext = cipher.decrypt(ciphertext)
    return plaintext


def main():
    key = b'Sixteen test key'  # len(key) 16 bytes
    plaintext = b'Hello, world! Test <h1>abcdefg!</h1>'

    ciphertext = rc4_encrypt(key, plaintext)
    decrypted_text = rc4_decrypt(key, ciphertext)

    print("Original message:", plaintext)
    print("Encrypted ARC4 message:", ciphertext)
    print("Decrypted ARC4 message:", decrypted_text.decode())


if __name__ == "__main__":
    main()
